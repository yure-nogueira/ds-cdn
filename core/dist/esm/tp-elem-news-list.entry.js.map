{"file":"tp-elem-news-list.entry.js","mappings":"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","names":[],"sources":["src/utils/api/institucional/utils/constants/requests.constant.ts","src/utils/api/institucional/news.api.ts","src/components/elementor/institucional/feature/news-list/utils/news-list.constant.ts","src/components/elementor/institucional/feature/news-list/news-list.scss?tag=tp-elem-news-list&encapsulation=scoped","src/components/elementor/institucional/feature/news-list/news-list.tsx"],"sourcesContent":["export const API_NEWS_ACTIONS = {\r\n  getNews: 'tp_get_news',\r\n};\r\n","import camelcaseKeys from 'camelcase-keys';\r\nimport { API_NEWS_ACTIONS } from './utils/constants/requests.constant';\r\nimport { ApiResponse } from './utils/interfaces/responses.interface';\r\nimport {\r\n  GetNewsParams,\r\n  GetNewsRespose,\r\n} from './utils/interfaces/news.interface';\r\n\r\nexport class ApiNews {\r\n  static async getNews(extraParams: GetNewsParams) {\r\n    const rawResponse = await fetch(`${process.env.AJAX_URL}`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n      body: new URLSearchParams(\r\n        Object.assign({ action: API_NEWS_ACTIONS.getNews, ...extraParams }),\r\n      ),\r\n    });\r\n\r\n    const response: ApiResponse = await rawResponse.json();\r\n    const { data: rawData } = response;\r\n    const data: GetNewsRespose = camelcaseKeys(rawData, { deep: true });\r\n\r\n    return data;\r\n  }\r\n}\r\n","import { getAssetPath } from '@stencil/core';\r\nimport { NewsListConfig } from './news-list.type';\r\n\r\nexport const NEWS_LIST: NewsListConfig = {\r\n  icons: {\r\n    searchX: getAssetPath('./assets/tp-search-x.svg'),\r\n    plus: getAssetPath('./assets/tp-plus.svg'),\r\n    wifiOff: getAssetPath('./assets/tp-wi-fi-off.svg'),\r\n  },\r\n  modeKeys: {\r\n    search: 'busca',\r\n    category: 'categoria',\r\n  },\r\n  defaultMode: 'all',\r\n  defaultPerPage: 5,\r\n};\r\n","@import '../../../../../styles/templarios.abstracts';\r\n\r\n:host {\r\n  display: block;\r\n}\r\n\r\n.tp-news-list {\r\n  &__list {\r\n    list-style: none;\r\n    display: none;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 32px;\r\n    margin: 0;\r\n    padding: 0;\r\n\r\n    @include breakpoint-down('lg') {\r\n      gap: 24px;\r\n    }\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n  }\r\n\r\n  &__item {\r\n    width: 100%;\r\n  }\r\n\r\n  &__link {\r\n    text-decoration: none;\r\n  }\r\n\r\n  &__warning {\r\n    display: none;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n\r\n    ::slotted([slot='not-found']) p,\r\n    ::slotted([slot='connection-error']) p {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  &__warning-icon {\r\n    width: 40px;\r\n    height: 40px;\r\n    margin-bottom: 24px;\r\n    color: var(--tp-color-neutral-10);\r\n  }\r\n\r\n  &__loader {\r\n    --tp-size: 48px;\r\n\r\n    display: none !important;\r\n    margin-top: 24px;\r\n\r\n    &--show {\r\n      display: flex !important;\r\n    }\r\n  }\r\n\r\n  &__button-container {\r\n    display: none;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-top: 40px;\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n  }\r\n}\r\n","import { Component, Host, Prop, State, Watch, h } from '@stencil/core';\r\nimport { ApiNews } from '../../../../../utils/api/institucional/news.api';\r\nimport { NEWS_LIST } from './utils/news-list.constant';\r\nimport { NewsItem } from './utils/news-list.type';\r\nimport { NewsListMode } from './utils/news-list.type';\r\n\r\n@Component({\r\n  tag: 'tp-elem-news-list',\r\n  styleUrl: 'news-list.scss',\r\n  scoped: true,\r\n  assetsDirs: ['assets'],\r\n})\r\nexport class TpElemNewsList {\r\n  /**\r\n   * Define o modo de uso do componente.\r\n   */\r\n  @Prop({ reflect: true }) mode: NewsListMode = NEWS_LIST.defaultMode;\r\n\r\n  /**\r\n   * Define a quantidade de items por página a serem carregados.\r\n   */\r\n  @Prop({ reflect: true }) perPage: number = NEWS_LIST.defaultPerPage;\r\n\r\n  /**\r\n   * Define a página atual.\r\n   */\r\n  @State() page: number = 1;\r\n\r\n  /**\r\n   * Define o total de páginas baseado nas configurações atuais.\r\n   * Configurações que impactam são: mode, perPage,\r\n   * termo de busca, categoria.\r\n   */\r\n  @State() totalPages: number;\r\n\r\n  /**\r\n   * Conjunto das notícias carregadas até o momento.\r\n   */\r\n  @State() news: NewsItem[];\r\n\r\n  /**\r\n   * Define se o compoenente está ou não carregando mais notícias.\r\n   */\r\n  @State() loading = true;\r\n\r\n  /**\r\n   * Define se o componente detectou falha de conexão com a rede.\r\n   */\r\n  @State() connectionError = false;\r\n\r\n  /**\r\n   * State and prop change listeners.\r\n   */\r\n  @Watch('page')\r\n  onLoadMore() {\r\n    this.getNews();\r\n  }\r\n\r\n  @Watch('perPage')\r\n  onPerPageChange() {\r\n    this.news = [];\r\n\r\n    if (this.page === 1) {\r\n      this.getNews();\r\n    } else {\r\n      this.page = 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Lifecycle hooks.\r\n   */\r\n  componentWillLoad() {\r\n    this.getNews();\r\n  }\r\n\r\n  /**\r\n   * Métodos internos\r\n   */\r\n  async getNews() {\r\n    try {\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const extraParams = { page: this.page, perPage: this.perPage };\r\n\r\n      if (this.mode === 'search') {\r\n        const search = urlParams.get(NEWS_LIST.modeKeys.search) || '';\r\n        Object.assign(extraParams, { search });\r\n      } else if (this.mode === 'category') {\r\n        const pathSegments = location.pathname.slice(0, -1).split('/');\r\n        const category = pathSegments[pathSegments.length - 1] || '';\r\n        Object.assign(extraParams, { category });\r\n      }\r\n\r\n      this.loading = true;\r\n      const { news, totalPages } = await ApiNews.getNews(extraParams);\r\n      this.loading = false;\r\n\r\n      if (this.totalPages !== totalPages) {\r\n        this.totalPages = totalPages;\r\n      }\r\n\r\n      if (this.connectionError) {\r\n        this.connectionError = false;\r\n      }\r\n\r\n      if (!this.news) {\r\n        return (this.news = news || []);\r\n      }\r\n\r\n      this.news = [...this.news, ...news];\r\n    } catch (error) {\r\n      this.loading = false;\r\n      this.connectionError = true;\r\n    }\r\n  }\r\n\r\n  getNewsItemList() {\r\n    return this.news.map((item) => (\r\n      <li class=\"tp-news-list__item\">\r\n        <a class=\"tp-news-list__link\" href={item.permalink}>\r\n          <tp-elem-news-item>\r\n            <img\r\n              slot=\"image\"\r\n              src={item.thumb}\r\n              title={item.titleText}\r\n              alt={item.altText}\r\n            />\r\n\r\n            {item.category && (\r\n              <ion-badge slot=\"category\" color=\"brand-4\">\r\n                {item.category}\r\n              </ion-badge>\r\n            )}\r\n            <ion-text slot=\"title\">\r\n              <h1>{item.title}</h1>\r\n            </ion-text>\r\n            <ion-text slot=\"date-time\" tp-type=\"p14x\" color=\"neutral-8\">\r\n              <time>\r\n                {item.date} - {item.time}\r\n              </time>\r\n            </ion-text>\r\n          </tp-elem-news-item>\r\n        </a>\r\n      </li>\r\n    ));\r\n  }\r\n\r\n  render() {\r\n    const { perPage, page, news, totalPages, loading, connectionError } = this;\r\n\r\n    const newsItems =\r\n      !news && loading\r\n        ? Array.from({ length: perPage }).map(() => (\r\n            <ion-skeleton-text\r\n              animated\r\n              tp-component=\"tp-elem-news-item\"\r\n            ></ion-skeleton-text>\r\n          ))\r\n        : news\r\n          ? this.getNewsItemList()\r\n          : null;\r\n\r\n    return (\r\n      <Host class=\"tp-news-list\">\r\n        <ul\r\n          class={{\r\n            'tp-news-list__list': true,\r\n            'tp-news-list__list--show': Boolean(news?.length) || loading,\r\n          }}\r\n        >\r\n          {newsItems}\r\n        </ul>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__warning': true,\r\n            'tp-news-list__warning--show': news && !news.length,\r\n          }}\r\n        >\r\n          <ion-icon\r\n            class=\"tp-news-list__warning-icon\"\r\n            src={NEWS_LIST.icons.searchX}\r\n          ></ion-icon>\r\n\r\n          <slot name=\"not-found\"></slot>\r\n        </div>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__warning': true,\r\n            'tp-news-list__warning--show': connectionError,\r\n          }}\r\n        >\r\n          <ion-icon\r\n            class=\"tp-news-list__warning-icon\"\r\n            src={NEWS_LIST.icons.wifiOff}\r\n          ></ion-icon>\r\n\r\n          <slot name=\"connection-error\" />\r\n        </div>\r\n\r\n        <tp-loader\r\n          class={{\r\n            'tp-news-list__loader': true,\r\n            'tp-news-list__loader--show': news?.length && loading,\r\n          }}\r\n          size=\"auto\"\r\n        ></tp-loader>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__button-container': true,\r\n            'tp-news-list__button-container--show':\r\n              page !== totalPages && news && Boolean(news.length),\r\n          }}\r\n        >\r\n          <ion-button\r\n            color=\"brand-4\"\r\n            /* @ts-ignore */\r\n            size=\"sm\"\r\n            disabled={loading}\r\n            onClick={() => this.page++}\r\n          >\r\n            Carregar mais\r\n            <ion-icon slot=\"end\" src={NEWS_LIST.icons.plus}></ion-icon>\r\n          </ion-button>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}