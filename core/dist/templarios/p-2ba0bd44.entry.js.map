{"version":3,"names":["TP_PRODUCT_LIST","PAGE_JUMP_AMOUNT","DEFAULT_PRODUCT_PER_PAGE","DIRECTIONS","FORWARD","BACKWARD","productListCss","TpElemProductListStyle0","TpElemProductList","this","selectInterfaceOptions","cssClass","orderby","order","page","onUpdatedFilter","categoryId","filter","params","Object","assign","category","updateProducts","onChangeFilter","event","detail","value","ORDERBY","DATE","POPULARITY","PRICE","PRICE_ASC","RATING","TITLE","onNavigateToPage","onGoToPreviousPage","currentPage","onGoToNextPage","onPageJump","direction","totalPages","componentWillLoad","getCurrentCart","onAddToCart","productId","success","cart","ApiCart","addToCart","error","console","log","onRemoveFromCart","id","removeFromCart","loadingProducts","products","ApiProduct","getOrderedProducts","getCart","render","productItems","Array","from","length","map","h","animated","product","permalink","name","regularPrice","price","stockQuantity","manageStock","stockStatus","alreadyOnCart","some","item","haveInStock","slot","color","href","currency","expand","onClick","Host","class","interface","interfaceOptions","placeholder","pageCount"],"sources":["src/components/elementor/ecommerce/feature/product-list/utils/product-list-constant.ts","src/components/elementor/ecommerce/feature/product-list/product-list.scss?tag=tp-elem-product-list&encapsulation=scoped","src/components/elementor/ecommerce/feature/product-list/product-list.tsx"],"sourcesContent":["export const TP_PRODUCT_LIST = {\r\n  PAGE_JUMP_AMOUNT: 3,\r\n  DEFAULT_PRODUCT_PER_PAGE: 10,\r\n  DIRECTIONS: {\r\n    FORWARD: 'forward',\r\n    BACKWARD: 'backward',\r\n  },\r\n};\r\n","@import '../../../../../styles/templarios.abstracts';\r\n\r\n.product-list {\r\n  &__top {\r\n    margin-bottom: 48px;\r\n  }\r\n\r\n  &__filter {\r\n    max-width: 320px;\r\n  }\r\n\r\n  &__middle {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fit, minmax(272px, 1fr));\r\n    gap: 20px 32px;\r\n    margin-bottom: 48px;\r\n  }\r\n}\r\n","import { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\nimport { ApiCart } from '../../../../../utils/api/ecommerce/cart.api';\r\nimport { ApiProduct } from '../../../../../utils/api/ecommerce/product.api';\r\nimport { ORDERBY } from '../../../../../utils/api/ecommerce/utils/constants/requests.constant';\r\nimport { CartItem } from '../../../../../utils/api/ecommerce/utils/interfaces/cart.interface';\r\nimport { Product } from '../../../../../utils/api/ecommerce/utils/interfaces/product.interface';\r\nimport { OrderedParams } from '../../../../../utils/api/ecommerce/utils/interfaces/requests.interface';\r\nimport { currency } from '../../../../../utils/filters/currency.filter';\r\nimport { TP_PRODUCT_LIST } from './utils/product-list-constant';\r\n\r\n@Component({\r\n  tag: 'tp-elem-product-list',\r\n  styleUrl: 'product-list.scss',\r\n  scoped: true,\r\n})\r\nexport class TpElemProductList {\r\n  /**\r\n   * O ID da categoria de produtos a serem listadas. Se nenhuma categoria\r\n   * for definida, todos os produtos serão listados.\r\n   */\r\n  @Prop() categoryId: number | null;\r\n\r\n  /**\r\n   * Um conjunto de objetos com todos os dados dos produtos à mostra.\r\n   */\r\n  @State() products: Product[];\r\n\r\n  /**\r\n   * O total de páginas de produtos\r\n   */\r\n  @State() totalPages: number;\r\n\r\n  /**\r\n   * Um conjunto de objetos com todos os dados dos produtos à mostra.\r\n   */\r\n  @State() cart: CartItem[] = [];\r\n\r\n  /**\r\n   * O total de páginas de produtos\r\n   */\r\n  @State() filter: OrderedParams = {\r\n    orderby: null,\r\n    order: null,\r\n    page: 1,\r\n  };\r\n\r\n  /**\r\n   * O total de páginas de produtos\r\n   */\r\n  @State() loadingProducts: boolean;\r\n\r\n  /**\r\n   * Objeto de configuração do select popover\r\n   */\r\n  selectInterfaceOptions = { cssClass: 'tp-popover-select' };\r\n\r\n  @Watch('filter')\r\n  onUpdatedFilter() {\r\n    const { categoryId, filter } = this;\r\n    const params = categoryId ? { ...filter, category: categoryId } : filter;\r\n\r\n    this.updateProducts(params);\r\n  }\r\n\r\n  @Listen('ionChange')\r\n  onChangeFilter(event: CustomEvent) {\r\n    if (!this.filter.orderby && event.detail.value === ORDERBY.DATE) return;\r\n\r\n    switch (event.detail.value) {\r\n      case ORDERBY.DATE:\r\n        this.filter = {\r\n          orderby: null,\r\n          order: null,\r\n          page: 1,\r\n        };\r\n        break;\r\n\r\n      case ORDERBY.POPULARITY:\r\n        this.filter = {\r\n          orderby: 'popularity',\r\n          order: null,\r\n          page: 1,\r\n        };\r\n        break;\r\n\r\n      case ORDERBY.PRICE:\r\n        this.filter = {\r\n          orderby: 'price',\r\n          order: null,\r\n          page: 1,\r\n        };\r\n        break;\r\n\r\n      case ORDERBY.PRICE_ASC:\r\n        this.filter = {\r\n          orderby: 'price',\r\n          order: 'asc',\r\n          page: 1,\r\n        };\r\n        break;\r\n\r\n      case ORDERBY.RATING:\r\n        this.filter = {\r\n          orderby: 'rating',\r\n          order: null,\r\n          page: 1,\r\n        };\r\n        break;\r\n\r\n      case ORDERBY.TITLE:\r\n        this.filter = {\r\n          orderby: 'title',\r\n          order: null,\r\n          page: 1,\r\n        };\r\n        break;\r\n    }\r\n  }\r\n\r\n  @Listen('tpNavigate')\r\n  onNavigateToPage(event: CustomEvent) {\r\n    const page = event.detail;\r\n\r\n    this.filter = { ...this.filter, page };\r\n  }\r\n\r\n  @Listen('tpPrevious')\r\n  onGoToPreviousPage() {\r\n    const currentPage = this.filter.page;\r\n    const page = currentPage - 1;\r\n\r\n    this.filter = { ...this.filter, page };\r\n  }\r\n\r\n  @Listen('tpNext')\r\n  onGoToNextPage() {\r\n    const currentPage = this.filter.page;\r\n    const page = currentPage + 1;\r\n\r\n    this.filter = { ...this.filter, page };\r\n  }\r\n\r\n  @Listen('tpPageJump')\r\n  onPageJump(event: CustomEvent) {\r\n    const currentPage = this.filter.page;\r\n    const direction = event.detail;\r\n    let page = currentPage;\r\n\r\n    if (direction === TP_PRODUCT_LIST.DIRECTIONS.FORWARD) {\r\n      page =\r\n        currentPage + TP_PRODUCT_LIST.PAGE_JUMP_AMOUNT > this.totalPages\r\n          ? this.totalPages\r\n          : currentPage + TP_PRODUCT_LIST.PAGE_JUMP_AMOUNT;\r\n    } else {\r\n      page =\r\n        currentPage - TP_PRODUCT_LIST.PAGE_JUMP_AMOUNT < 1\r\n          ? 1\r\n          : currentPage - TP_PRODUCT_LIST.PAGE_JUMP_AMOUNT;\r\n    }\r\n\r\n    this.filter = { ...this.filter, page };\r\n  }\r\n\r\n  async componentWillLoad() {\r\n    const params = this.categoryId ? { category: this.categoryId } : {};\r\n\r\n    this.updateProducts(params);\r\n    this.getCurrentCart();\r\n  }\r\n\r\n  async onAddToCart(productId: number) {\r\n    try {\r\n      const { success, cart } = await ApiCart.addToCart(productId, 1);\r\n      if (success) this.cart = cart;\r\n    } catch (error) {\r\n      console.log('Não foi possível adicionar item ao carrinho.');\r\n    }\r\n  }\r\n\r\n  async onRemoveFromCart(id: number) {\r\n    try {\r\n      const { success, cart } = await ApiCart.removeFromCart(id);\r\n      if (success) this.cart = cart;\r\n    } catch (error) {\r\n      console.log('Não foi possível remover o item do carrinho.');\r\n    }\r\n  }\r\n\r\n  async updateProducts(params: OrderedParams = {}) {\r\n    this.loadingProducts = true;\r\n\r\n    const { products, totalPages } =\r\n      await ApiProduct.getOrderedProducts(params);\r\n\r\n    this.products = products;\r\n    if (totalPages !== this.totalPages) this.totalPages = totalPages;\r\n\r\n    this.loadingProducts = false;\r\n  }\r\n\r\n  async getCurrentCart() {\r\n    try {\r\n      const { cart } = await ApiCart.getCart();\r\n      this.cart = cart;\r\n    } catch (error) {\r\n      console.log('Não foi possível ter acesso ao carrinho.');\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      products,\r\n      totalPages,\r\n      filter: { page },\r\n      loadingProducts,\r\n      selectInterfaceOptions,\r\n    } = this;\r\n\r\n    const productItems = loadingProducts\r\n      ? Array.from({ length: TP_PRODUCT_LIST.DEFAULT_PRODUCT_PER_PAGE }).map(\r\n          () => (\r\n            <ion-skeleton-text\r\n              animated\r\n              tp-component=\"tp-elem-product-item\"\r\n            ></ion-skeleton-text>\r\n          ),\r\n        )\r\n      : products.map((product) => {\r\n          const {\r\n            permalink,\r\n            id,\r\n            name,\r\n            regularPrice,\r\n            price,\r\n            stockQuantity,\r\n            manageStock,\r\n            stockStatus,\r\n          } = product;\r\n\r\n          const alreadyOnCart = this.cart.some((item) => item.id === id);\r\n          const haveInStock =\r\n            (manageStock && stockQuantity >= 1) ||\r\n            (!manageStock && stockStatus === 'instock');\r\n\r\n          return (\r\n            <tp-elem-product-item product={product}>\r\n              <ion-text slot=\"title\" tp-type=\"p18xb\" color=\"neutral-10\">\r\n                <h3>\r\n                  <a href={permalink}>{name}</a>\r\n                </h3>\r\n              </ion-text>\r\n\r\n              <ion-text slot=\"regular-price\" color=\"neutral-6\" tp-type=\"p14\">\r\n                <p>{currency(regularPrice, 'pt-br')}</p>\r\n              </ion-text>\r\n\r\n              <ion-text slot=\"price\" color=\"neutral-8\">\r\n                <p>{currency(price, 'pt-br')}</p>\r\n              </ion-text>\r\n\r\n              {haveInStock && !alreadyOnCart && (\r\n                <ion-button\r\n                  slot=\"button\"\r\n                  color=\"neutral-2\"\r\n                  expand=\"block\"\r\n                  onClick={() => this.onAddToCart(id)}\r\n                >\r\n                  Adicionar ao Carrinho\r\n                </ion-button>\r\n              )}\r\n\r\n              {haveInStock && alreadyOnCart && (\r\n                <ion-button\r\n                  slot=\"button\"\r\n                  color=\"warning\"\r\n                  expand=\"block\"\r\n                  onClick={() => this.onRemoveFromCart(id)}\r\n                >\r\n                  Remover do Carrinho\r\n                </ion-button>\r\n              )}\r\n            </tp-elem-product-item>\r\n          );\r\n        });\r\n\r\n    return (\r\n      <Host>\r\n        <div class=\"product-list\">\r\n          <div class=\"product-list__top\">\r\n            <tp-input-container class=\"product-list__filter\">\r\n              <ion-select\r\n                interface=\"popover\"\r\n                interfaceOptions={selectInterfaceOptions}\r\n                placeholder=\"Filtrar\"\r\n              >\r\n                <ion-select-option value=\"date\">Padrão</ion-select-option>\r\n                <ion-select-option value=\"popularity\">\r\n                  Classificar por popularidade\r\n                </ion-select-option>\r\n                <ion-select-option value=\"rating\">\r\n                  Classificar por avaliação\r\n                </ion-select-option>\r\n                <ion-select-option value=\"price-asc\">\r\n                  Classificar por menor preço\r\n                </ion-select-option>\r\n                <ion-select-option value=\"price\">\r\n                  Classificar por maior preço\r\n                </ion-select-option>\r\n              </ion-select>\r\n            </tp-input-container>\r\n          </div>\r\n\r\n          <div class=\"product-list__middle\">{productItems}</div>\r\n\r\n          {totalPages > 1 && (\r\n            <div class=\"product-list__bottom\">\r\n              <tp-pagination\r\n                pageCount={totalPages}\r\n                currentPage={page}\r\n              ></tp-pagination>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"gKAAO,MAAMA,EAAkB,CAC7BC,iBAAkB,EAClBC,yBAA0B,GAC1BC,WAAY,CACVC,QAAS,UACTC,SAAU,aCLd,MAAMC,EAAiB,sRACvB,MAAAC,EAAeD,E,MCcFE,EAAiB,M,yBAuC5BC,KAAAC,uBAAyB,CAAEC,SAAU,qB,sFAnBT,G,YAKK,CAC/BC,QAAS,KACTC,MAAO,KACPC,KAAM,G,+BAcR,eAAAC,GACE,MAAMC,WAAEA,EAAUC,OAAEA,GAAWR,KAC/B,MAAMS,EAASF,EAAUG,OAAAC,OAAAD,OAAAC,OAAA,GAAQH,GAAM,CAAEI,SAAUL,IAAeC,EAElER,KAAKa,eAAeJ,E,CAItB,cAAAK,CAAeC,GACb,IAAKf,KAAKQ,OAAOL,SAAWY,EAAMC,OAAOC,QAAUC,EAAQC,KAAM,OAEjE,OAAQJ,EAAMC,OAAOC,OACnB,KAAKC,EAAQC,KACXnB,KAAKQ,OAAS,CACZL,QAAS,KACTC,MAAO,KACPC,KAAM,GAER,MAEF,KAAKa,EAAQE,WACXpB,KAAKQ,OAAS,CACZL,QAAS,aACTC,MAAO,KACPC,KAAM,GAER,MAEF,KAAKa,EAAQG,MACXrB,KAAKQ,OAAS,CACZL,QAAS,QACTC,MAAO,KACPC,KAAM,GAER,MAEF,KAAKa,EAAQI,UACXtB,KAAKQ,OAAS,CACZL,QAAS,QACTC,MAAO,MACPC,KAAM,GAER,MAEF,KAAKa,EAAQK,OACXvB,KAAKQ,OAAS,CACZL,QAAS,SACTC,MAAO,KACPC,KAAM,GAER,MAEF,KAAKa,EAAQM,MACXxB,KAAKQ,OAAS,CACZL,QAAS,QACTC,MAAO,KACPC,KAAM,GAER,M,CAKN,gBAAAoB,CAAiBV,GACf,MAAMV,EAAOU,EAAMC,OAEnBhB,KAAKQ,OAAME,OAAAC,OAAAD,OAAAC,OAAA,GAAQX,KAAKQ,QAAM,CAAEH,Q,CAIlC,kBAAAqB,GACE,MAAMC,EAAc3B,KAAKQ,OAAOH,KAChC,MAAMA,EAAOsB,EAAc,EAE3B3B,KAAKQ,OAAME,OAAAC,OAAAD,OAAAC,OAAA,GAAQX,KAAKQ,QAAM,CAAEH,Q,CAIlC,cAAAuB,GACE,MAAMD,EAAc3B,KAAKQ,OAAOH,KAChC,MAAMA,EAAOsB,EAAc,EAE3B3B,KAAKQ,OAAME,OAAAC,OAAAD,OAAAC,OAAA,GAAQX,KAAKQ,QAAM,CAAEH,Q,CAIlC,UAAAwB,CAAWd,GACT,MAAMY,EAAc3B,KAAKQ,OAAOH,KAChC,MAAMyB,EAAYf,EAAMC,OACxB,IAAIX,EAAOsB,EAEX,GAAIG,IAAcvC,EAAgBG,WAAWC,QAAS,CACpDU,EACEsB,EAAcpC,EAAgBC,iBAAmBQ,KAAK+B,WAClD/B,KAAK+B,WACLJ,EAAcpC,EAAgBC,gB,KAC/B,CACLa,EACEsB,EAAcpC,EAAgBC,iBAAmB,EAC7C,EACAmC,EAAcpC,EAAgBC,gB,CAGtCQ,KAAKQ,OAAME,OAAAC,OAAAD,OAAAC,OAAA,GAAQX,KAAKQ,QAAM,CAAEH,Q,CAGlC,uBAAM2B,GACJ,MAAMvB,EAAST,KAAKO,WAAa,CAAEK,SAAUZ,KAAKO,YAAe,GAEjEP,KAAKa,eAAeJ,GACpBT,KAAKiC,gB,CAGP,iBAAMC,CAAYC,GAChB,IACE,MAAMC,QAAEA,EAAOC,KAAEA,SAAeC,EAAQC,UAAUJ,EAAW,GAC7D,GAAIC,EAASpC,KAAKqC,KAAOA,C,CACzB,MAAOG,GACPC,QAAQC,IAAI,+C,EAIhB,sBAAMC,CAAiBC,GACrB,IACE,MAAMR,QAAEA,EAAOC,KAAEA,SAAeC,EAAQO,eAAeD,GACvD,GAAIR,EAASpC,KAAKqC,KAAOA,C,CACzB,MAAOG,GACPC,QAAQC,IAAI,+C,EAIhB,oBAAM7B,CAAeJ,EAAwB,IAC3CT,KAAK8C,gBAAkB,KAEvB,MAAMC,SAAEA,EAAQhB,WAAEA,SACViB,EAAWC,mBAAmBxC,GAEtCT,KAAK+C,SAAWA,EAChB,GAAIhB,IAAe/B,KAAK+B,WAAY/B,KAAK+B,WAAaA,EAEtD/B,KAAK8C,gBAAkB,K,CAGzB,oBAAMb,GACJ,IACE,MAAMI,KAAEA,SAAeC,EAAQY,UAC/BlD,KAAKqC,KAAOA,C,CACZ,MAAOG,GACPC,QAAQC,IAAI,2C,EAIhB,MAAAS,GACE,MAAMJ,SACJA,EAAQhB,WACRA,EACAvB,QAAQH,KAAEA,GAAMyC,gBAChBA,EAAe7C,uBACfA,GACED,KAEJ,MAAMoD,EAAeN,EACjBO,MAAMC,KAAK,CAAEC,OAAQhE,EAAgBE,2BAA4B+D,KAC/D,IACEC,EAAA,qBACEC,SAAQ,oBACK,2BAInBX,EAASS,KAAKG,IACZ,MAAMC,UACJA,EAAShB,GACTA,EAAEiB,KACFA,EAAIC,aACJA,EAAYC,MACZA,EAAKC,cACLA,EAAaC,YACbA,EAAWC,YACXA,GACEP,EAEJ,MAAMQ,EAAgBnE,KAAKqC,KAAK+B,MAAMC,GAASA,EAAKzB,KAAOA,IAC3D,MAAM0B,EACHL,GAAeD,GAAiB,IAC/BC,GAAeC,IAAgB,UAEnC,OACET,EAAA,wBAAsBE,QAASA,GAC7BF,EAAA,YAAUc,KAAK,QAAO,UAAS,QAAQC,MAAM,cAC3Cf,EAAA,UACEA,EAAA,KAAGgB,KAAMb,GAAYC,KAIzBJ,EAAA,YAAUc,KAAK,gBAAgBC,MAAM,YAAW,UAAS,OACvDf,EAAA,SAAIiB,EAASZ,EAAc,WAG7BL,EAAA,YAAUc,KAAK,QAAQC,MAAM,aAC3Bf,EAAA,SAAIiB,EAASX,EAAO,WAGrBO,IAAgBH,GACfV,EAAA,cACEc,KAAK,SACLC,MAAM,YACNG,OAAO,QACPC,QAAS,IAAM5E,KAAKkC,YAAYU,IAAG,yBAMtC0B,GAAeH,GACdV,EAAA,cACEc,KAAK,SACLC,MAAM,UACNG,OAAO,QACPC,QAAS,IAAM5E,KAAK2C,iBAAiBC,IAAG,uBAKvB,IAI/B,OACEa,EAACoB,EAAI,KACHpB,EAAA,OAAKqB,MAAM,gBACTrB,EAAA,OAAKqB,MAAM,qBACTrB,EAAA,sBAAoBqB,MAAM,wBACxBrB,EAAA,cACEsB,UAAU,UACVC,iBAAkB/E,EAClBgF,YAAY,WAEZxB,EAAA,qBAAmBxC,MAAM,QAAM,UAC/BwC,EAAA,qBAAmBxC,MAAM,cAAY,gCAGrCwC,EAAA,qBAAmBxC,MAAM,UAAQ,6BAGjCwC,EAAA,qBAAmBxC,MAAM,aAAW,+BAGpCwC,EAAA,qBAAmBxC,MAAM,SAAO,kCAOtCwC,EAAA,OAAKqB,MAAM,wBAAwB1B,GAElCrB,EAAa,GACZ0B,EAAA,OAAKqB,MAAM,wBACTrB,EAAA,iBACEyB,UAAWnD,EACXJ,YAAatB,M"}