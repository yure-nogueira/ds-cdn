import{r as t,h as e,H as o}from"./p-5c36ed66.js";import{A as s}from"./p-228049e3.js";import{O as r,A as i,c as a}from"./p-e5dad5d1.js";import"./p-e5cf9adb.js";const c={PAGE_JUMP_AMOUNT:3,DEFAULT_PRODUCT_PER_PAGE:10,DIRECTIONS:{FORWARD:"forward",BACKWARD:"backward"}};const n=".product-list__top.sc-tp-elem-product-list{margin-bottom:48px}.product-list__filter.sc-tp-elem-product-list{max-width:320px}.product-list__middle.sc-tp-elem-product-list{display:grid;grid-template-columns:repeat(auto-fit, minmax(272px, 1fr));gap:20px 32px;margin-bottom:48px}";const l=n;const p=class{constructor(e){t(this,e);this.selectInterfaceOptions={cssClass:"tp-popover-select"};this.categoryId=undefined;this.products=undefined;this.totalPages=undefined;this.cart=[];this.filter={orderby:null,order:null,page:1};this.loadingProducts=undefined}onUpdatedFilter(){const{categoryId:t,filter:e}=this;const o=t?Object.assign(Object.assign({},e),{category:t}):e;this.updateProducts(o)}onChangeFilter(t){if(!this.filter.orderby&&t.detail.value===r.DATE)return;switch(t.detail.value){case r.DATE:this.filter={orderby:null,order:null,page:1};break;case r.POPULARITY:this.filter={orderby:"popularity",order:null,page:1};break;case r.PRICE:this.filter={orderby:"price",order:null,page:1};break;case r.PRICE_ASC:this.filter={orderby:"price",order:"asc",page:1};break;case r.RATING:this.filter={orderby:"rating",order:null,page:1};break;case r.TITLE:this.filter={orderby:"title",order:null,page:1};break}}onNavigateToPage(t){const e=t.detail;this.filter=Object.assign(Object.assign({},this.filter),{page:e})}onGoToPreviousPage(){const t=this.filter.page;const e=t-1;this.filter=Object.assign(Object.assign({},this.filter),{page:e})}onGoToNextPage(){const t=this.filter.page;const e=t+1;this.filter=Object.assign(Object.assign({},this.filter),{page:e})}onPageJump(t){const e=this.filter.page;const o=t.detail;let s=e;if(o===c.DIRECTIONS.FORWARD){s=e+c.PAGE_JUMP_AMOUNT>this.totalPages?this.totalPages:e+c.PAGE_JUMP_AMOUNT}else{s=e-c.PAGE_JUMP_AMOUNT<1?1:e-c.PAGE_JUMP_AMOUNT}this.filter=Object.assign(Object.assign({},this.filter),{page:s})}async componentWillLoad(){const t=this.categoryId?{category:this.categoryId}:{};this.updateProducts(t);this.getCurrentCart()}async onAddToCart(t){try{const{success:e,cart:o}=await s.addToCart(t,1);if(e)this.cart=o}catch(t){console.log("Não foi possível adicionar item ao carrinho.")}}async onRemoveFromCart(t){try{const{success:e,cart:o}=await s.removeFromCart(t);if(e)this.cart=o}catch(t){console.log("Não foi possível remover o item do carrinho.")}}async updateProducts(t={}){this.loadingProducts=true;const{products:e,totalPages:o}=await i.getOrderedProducts(t);this.products=e;if(o!==this.totalPages)this.totalPages=o;this.loadingProducts=false}async getCurrentCart(){try{const{cart:t}=await s.getCart();this.cart=t}catch(t){console.log("Não foi possível ter acesso ao carrinho.")}}render(){const{products:t,totalPages:s,filter:{page:r},loadingProducts:i,selectInterfaceOptions:n}=this;const l=i?Array.from({length:c.DEFAULT_PRODUCT_PER_PAGE}).map((()=>e("ion-skeleton-text",{animated:true,"tp-component":"tp-elem-product-item"}))):t.map((t=>{const{permalink:o,id:s,name:r,regularPrice:i,price:c,stockQuantity:n,manageStock:l,stockStatus:p}=t;const d=this.cart.some((t=>t.id===s));const u=l&&n>=1||!l&&p==="instock";return e("tp-elem-product-item",{product:t},e("ion-text",{slot:"title","tp-type":"p18xb",color:"neutral-10"},e("h3",null,e("a",{href:o},r))),e("ion-text",{slot:"regular-price",color:"neutral-6","tp-type":"p14"},e("p",null,a(i,"pt-br"))),e("ion-text",{slot:"price",color:"neutral-8"},e("p",null,a(c,"pt-br"))),u&&!d&&e("ion-button",{slot:"button",color:"neutral-2",expand:"block",onClick:()=>this.onAddToCart(s)},"Adicionar ao Carrinho"),u&&d&&e("ion-button",{slot:"button",color:"warning",expand:"block",onClick:()=>this.onRemoveFromCart(s)},"Remover do Carrinho"))}));return e(o,null,e("div",{class:"product-list"},e("div",{class:"product-list__top"},e("tp-input-container",{class:"product-list__filter"},e("ion-select",{interface:"popover",interfaceOptions:n,placeholder:"Filtrar"},e("ion-select-option",{value:"date"},"Padrão"),e("ion-select-option",{value:"popularity"},"Classificar por popularidade"),e("ion-select-option",{value:"rating"},"Classificar por avaliação"),e("ion-select-option",{value:"price-asc"},"Classificar por menor preço"),e("ion-select-option",{value:"price"},"Classificar por maior preço")))),e("div",{class:"product-list__middle"},l),s>1&&e("div",{class:"product-list__bottom"},e("tp-pagination",{pageCount:s,currentPage:r}))))}static get watchers(){return{filter:["onUpdatedFilter"]}}};p.style=l;export{p as tp_elem_product_list};
//# sourceMappingURL=p-2ba0bd44.entry.js.map