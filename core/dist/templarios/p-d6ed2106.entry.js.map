{"version":3,"names":["API_NEWS_ACTIONS","getNews","ApiNews","extraParams","rawResponse","fetch","process","env","AJAX_URL","method","headers","body","URLSearchParams","Object","assign","action","response","json","data","rawData","camelcaseKeys","deep","NEWS_LIST","icons","searchX","getAssetPath","plus","wifiOff","modeKeys","search","category","defaultMode","defaultPerPage","newsListCss","TpElemNewsListStyle0","TpElemNewsList","onLoadMore","this","onPerPageChange","news","page","componentWillLoad","urlParams","window","location","perPage","mode","get","pathSegments","pathname","slice","split","length","loading","totalPages","connectionError","error","getNewsItemList","map","item","h","class","href","permalink","slot","src","thumb","title","titleText","alt","altText","color","date","time","render","newsItems","Array","from","animated","Host","key","Boolean","name","size","disabled","onClick"],"sources":["src/utils/api/institucional/utils/constants/requests.constant.ts","src/utils/api/institucional/news.api.ts","src/components/elementor/institucional/feature/news-list/utils/news-list.constant.ts","src/components/elementor/institucional/feature/news-list/news-list.scss?tag=tp-elem-news-list&encapsulation=scoped","src/components/elementor/institucional/feature/news-list/news-list.tsx"],"sourcesContent":["export const API_NEWS_ACTIONS = {\r\n  getNews: 'tp_get_news',\r\n};\r\n","import camelcaseKeys from 'camelcase-keys';\r\nimport { API_NEWS_ACTIONS } from './utils/constants/requests.constant';\r\nimport { ApiResponse } from './utils/interfaces/responses.interface';\r\nimport {\r\n  GetNewsParams,\r\n  GetNewsRespose,\r\n} from './utils/interfaces/news.interface';\r\n\r\nexport class ApiNews {\r\n  static async getNews(extraParams: GetNewsParams) {\r\n    const rawResponse = await fetch(`${process.env.AJAX_URL}`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n      body: new URLSearchParams(\r\n        Object.assign({ action: API_NEWS_ACTIONS.getNews, ...extraParams }),\r\n      ),\r\n    });\r\n\r\n    const response: ApiResponse = await rawResponse.json();\r\n    const { data: rawData } = response;\r\n    const data: GetNewsRespose = camelcaseKeys(rawData, { deep: true });\r\n\r\n    return data;\r\n  }\r\n}\r\n","import { getAssetPath } from '@stencil/core';\r\nimport { NewsListConfig } from './news-list.type';\r\n\r\nexport const NEWS_LIST: NewsListConfig = {\r\n  icons: {\r\n    searchX: getAssetPath('./assets/tp-search-x.svg'),\r\n    plus: getAssetPath('./assets/tp-plus.svg'),\r\n    wifiOff: getAssetPath('./assets/tp-wi-fi-off.svg'),\r\n  },\r\n  modeKeys: {\r\n    search: 'busca',\r\n    category: 'categoria',\r\n  },\r\n  defaultMode: 'all',\r\n  defaultPerPage: 5,\r\n};\r\n","@import '../../../../../styles/templarios.abstracts';\r\n\r\n:host {\r\n  display: block;\r\n}\r\n\r\n.tp-news-list {\r\n  &__list {\r\n    list-style: none;\r\n    display: none;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 32px;\r\n    margin: 0;\r\n    padding: 0;\r\n\r\n    @include breakpoint-down('lg') {\r\n      gap: 24px;\r\n    }\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n  }\r\n\r\n  &__item {\r\n    width: 100%;\r\n  }\r\n\r\n  &__link {\r\n    text-decoration: none;\r\n  }\r\n\r\n  &__warning {\r\n    display: none;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n\r\n    ::slotted([slot='not-found']) p,\r\n    ::slotted([slot='connection-error']) p {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  &__warning-icon {\r\n    width: 40px;\r\n    height: 40px;\r\n    margin-bottom: 24px;\r\n    color: var(--tp-color-neutral-10);\r\n  }\r\n\r\n  &__loader {\r\n    --tp-size: 48px;\r\n\r\n    display: none !important;\r\n    margin-top: 24px;\r\n\r\n    &--show {\r\n      display: flex !important;\r\n    }\r\n  }\r\n\r\n  &__button-container {\r\n    display: none;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-top: 40px;\r\n\r\n    &--show {\r\n      display: flex;\r\n    }\r\n  }\r\n}\r\n","import { Component, Host, Prop, State, Watch, h } from '@stencil/core';\r\nimport { ApiNews } from '../../../../../utils/api/institucional/news.api';\r\nimport { NEWS_LIST } from './utils/news-list.constant';\r\nimport { NewsItem } from './utils/news-list.type';\r\nimport { NewsListMode } from './utils/news-list.type';\r\n\r\n@Component({\r\n  tag: 'tp-elem-news-list',\r\n  styleUrl: 'news-list.scss',\r\n  scoped: true,\r\n  assetsDirs: ['assets'],\r\n})\r\nexport class TpElemNewsList {\r\n  /**\r\n   * Define o modo de uso do componente.\r\n   */\r\n  @Prop({ reflect: true }) mode: NewsListMode = NEWS_LIST.defaultMode;\r\n\r\n  /**\r\n   * Define a quantidade de items por página a serem carregados.\r\n   */\r\n  @Prop({ reflect: true }) perPage: number = NEWS_LIST.defaultPerPage;\r\n\r\n  /**\r\n   * Define a página atual.\r\n   */\r\n  @State() page: number = 1;\r\n\r\n  /**\r\n   * Define o total de páginas baseado nas configurações atuais.\r\n   * Configurações que impactam são: mode, perPage,\r\n   * termo de busca, categoria.\r\n   */\r\n  @State() totalPages: number;\r\n\r\n  /**\r\n   * Conjunto das notícias carregadas até o momento.\r\n   */\r\n  @State() news: NewsItem[];\r\n\r\n  /**\r\n   * Define se o compoenente está ou não carregando mais notícias.\r\n   */\r\n  @State() loading = true;\r\n\r\n  /**\r\n   * Define se o componente detectou falha de conexão com a rede.\r\n   */\r\n  @State() connectionError = false;\r\n\r\n  /**\r\n   * State and prop change listeners.\r\n   */\r\n  @Watch('page')\r\n  onLoadMore() {\r\n    this.getNews();\r\n  }\r\n\r\n  @Watch('perPage')\r\n  onPerPageChange() {\r\n    this.news = [];\r\n\r\n    if (this.page === 1) {\r\n      this.getNews();\r\n    } else {\r\n      this.page = 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Lifecycle hooks.\r\n   */\r\n  componentWillLoad() {\r\n    this.getNews();\r\n  }\r\n\r\n  /**\r\n   * Métodos internos\r\n   */\r\n  async getNews() {\r\n    try {\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const extraParams = { page: this.page, perPage: this.perPage };\r\n\r\n      if (this.mode === 'search') {\r\n        const search = urlParams.get(NEWS_LIST.modeKeys.search) || '';\r\n        Object.assign(extraParams, { search });\r\n      } else if (this.mode === 'category') {\r\n        const pathSegments = location.pathname.slice(0, -1).split('/');\r\n        const category = pathSegments[pathSegments.length - 1] || '';\r\n        Object.assign(extraParams, { category });\r\n      }\r\n\r\n      this.loading = true;\r\n      const { news, totalPages } = await ApiNews.getNews(extraParams);\r\n      this.loading = false;\r\n\r\n      if (this.totalPages !== totalPages) {\r\n        this.totalPages = totalPages;\r\n      }\r\n\r\n      if (this.connectionError) {\r\n        this.connectionError = false;\r\n      }\r\n\r\n      if (!this.news) {\r\n        return (this.news = news || []);\r\n      }\r\n\r\n      this.news = [...this.news, ...news];\r\n    } catch (error) {\r\n      this.loading = false;\r\n      this.connectionError = true;\r\n    }\r\n  }\r\n\r\n  getNewsItemList() {\r\n    return this.news.map((item) => (\r\n      <li class=\"tp-news-list__item\">\r\n        <a class=\"tp-news-list__link\" href={item.permalink}>\r\n          <tp-elem-news-item>\r\n            <img\r\n              slot=\"image\"\r\n              src={item.thumb}\r\n              title={item.titleText}\r\n              alt={item.altText}\r\n            />\r\n\r\n            {item.category && (\r\n              <ion-badge slot=\"category\" color=\"brand-4\">\r\n                {item.category}\r\n              </ion-badge>\r\n            )}\r\n            <ion-text slot=\"title\">\r\n              <h1>{item.title}</h1>\r\n            </ion-text>\r\n            <ion-text slot=\"date-time\" tp-type=\"p14x\" color=\"neutral-8\">\r\n              <time>\r\n                {item.date} - {item.time}\r\n              </time>\r\n            </ion-text>\r\n          </tp-elem-news-item>\r\n        </a>\r\n      </li>\r\n    ));\r\n  }\r\n\r\n  render() {\r\n    const { perPage, page, news, totalPages, loading, connectionError } = this;\r\n\r\n    const newsItems =\r\n      !news && loading\r\n        ? Array.from({ length: perPage }).map(() => (\r\n            <ion-skeleton-text\r\n              animated\r\n              tp-component=\"tp-elem-news-item\"\r\n            ></ion-skeleton-text>\r\n          ))\r\n        : news\r\n          ? this.getNewsItemList()\r\n          : null;\r\n\r\n    return (\r\n      <Host class=\"tp-news-list\">\r\n        <ul\r\n          class={{\r\n            'tp-news-list__list': true,\r\n            'tp-news-list__list--show': Boolean(news?.length) || loading,\r\n          }}\r\n        >\r\n          {newsItems}\r\n        </ul>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__warning': true,\r\n            'tp-news-list__warning--show': news && !news.length,\r\n          }}\r\n        >\r\n          <ion-icon\r\n            class=\"tp-news-list__warning-icon\"\r\n            src={NEWS_LIST.icons.searchX}\r\n          ></ion-icon>\r\n\r\n          <slot name=\"not-found\"></slot>\r\n        </div>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__warning': true,\r\n            'tp-news-list__warning--show': connectionError,\r\n          }}\r\n        >\r\n          <ion-icon\r\n            class=\"tp-news-list__warning-icon\"\r\n            src={NEWS_LIST.icons.wifiOff}\r\n          ></ion-icon>\r\n\r\n          <slot name=\"connection-error\" />\r\n        </div>\r\n\r\n        <tp-loader\r\n          class={{\r\n            'tp-news-list__loader': true,\r\n            'tp-news-list__loader--show': news?.length && loading,\r\n          }}\r\n          size=\"auto\"\r\n        ></tp-loader>\r\n\r\n        <div\r\n          class={{\r\n            'tp-news-list__button-container': true,\r\n            'tp-news-list__button-container--show':\r\n              page !== totalPages && news && Boolean(news.length),\r\n          }}\r\n        >\r\n          <ion-button\r\n            color=\"brand-4\"\r\n            /* @ts-ignore */\r\n            size=\"sm\"\r\n            disabled={loading}\r\n            onClick={() => this.page++}\r\n          >\r\n            Carregar mais\r\n            <ion-icon slot=\"end\" src={NEWS_LIST.icons.plus}></ion-icon>\r\n          </ion-button>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}