import{g as t,r as e,h as s,H as n}from"./p-5c36ed66.js";import{c as i}from"./p-e5cf9adb.js";const a={getNews:"tp_get_news"};class l{static async getNews(t){const e=await fetch(`${process.env.AJAX_URL}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(Object.assign(Object.assign({action:a.getNews},t)))});const s=await e.json();const{data:n}=s;const l=i(n,{deep:true});return l}}const o={icons:{searchX:t("./assets/tp-search-x.svg"),plus:t("./assets/tp-plus.svg"),wifiOff:t("./assets/tp-wi-fi-off.svg")},modeKeys:{search:"busca",category:"categoria"},defaultMode:"all",defaultPerPage:5};const c=".sc-tp-elem-news-list-h{display:block}.tp-news-list__list.sc-tp-elem-news-list{list-style:none;display:none;flex-direction:column;justify-content:center;align-items:center;gap:32px;margin:0;padding:0}@media (max-width: 991.98px){.tp-news-list__list.sc-tp-elem-news-list{gap:24px}}.tp-news-list__list--show.sc-tp-elem-news-list{display:flex}.tp-news-list__item.sc-tp-elem-news-list{width:100%}.tp-news-list__link.sc-tp-elem-news-list{text-decoration:none}.tp-news-list__warning.sc-tp-elem-news-list{display:none;flex-direction:column;justify-content:center;align-items:center}.tp-news-list__warning--show.sc-tp-elem-news-list{display:flex}.tp-news-list__warning.sc-tp-elem-news-list-s>[slot=not-found] p,.tp-news-list__warning .sc-tp-elem-news-list-s>[slot=not-found] p,.tp-news-list__warning.sc-tp-elem-news-list-s>[slot=connection-error] p,.tp-news-list__warning .sc-tp-elem-news-list-s>[slot=connection-error] p{text-align:center}.tp-news-list__warning-icon.sc-tp-elem-news-list{width:40px;height:40px;margin-bottom:24px;color:var(--tp-color-neutral-10)}.tp-news-list__loader.sc-tp-elem-news-list{--tp-size:48px;display:none !important;margin-top:24px}.tp-news-list__loader--show.sc-tp-elem-news-list{display:flex !important}.tp-news-list__button-container.sc-tp-elem-news-list{display:none;align-items:center;justify-content:center;margin-top:40px}.tp-news-list__button-container--show.sc-tp-elem-news-list{display:flex}";const r=c;const p=class{constructor(t){e(this,t);this.mode=o.defaultMode;this.perPage=o.defaultPerPage;this.page=1;this.totalPages=undefined;this.news=undefined;this.loading=true;this.connectionError=false}onLoadMore(){this.getNews()}onPerPageChange(){this.news=[];if(this.page===1){this.getNews()}else{this.page=1}}componentWillLoad(){this.getNews()}async getNews(){try{const t=new URLSearchParams(window.location.search);const e={page:this.page,perPage:this.perPage};if(this.mode==="search"){const s=t.get(o.modeKeys.search)||"";Object.assign(e,{search:s})}else if(this.mode==="category"){const t=location.pathname.slice(0,-1).split("/");const s=t[t.length-1]||"";Object.assign(e,{category:s})}this.loading=true;const{news:s,totalPages:n}=await l.getNews(e);this.loading=false;if(this.totalPages!==n){this.totalPages=n}if(this.connectionError){this.connectionError=false}if(!this.news){return this.news=s||[]}this.news=[...this.news,...s]}catch(t){this.loading=false;this.connectionError=true}}getNewsItemList(){return this.news.map((t=>s("li",{class:"tp-news-list__item"},s("a",{class:"tp-news-list__link",href:t.permalink},s("tp-elem-news-item",null,s("img",{slot:"image",src:t.thumb,title:t.titleText,alt:t.altText}),t.category&&s("ion-badge",{slot:"category",color:"brand-4"},t.category),s("ion-text",{slot:"title"},s("h1",null,t.title)),s("ion-text",{slot:"date-time","tp-type":"p14x",color:"neutral-8"},s("time",null,t.date," - ",t.time)))))))}render(){const{perPage:t,page:e,news:i,totalPages:a,loading:l,connectionError:c}=this;const r=!i&&l?Array.from({length:t}).map((()=>s("ion-skeleton-text",{animated:true,"tp-component":"tp-elem-news-item"}))):i?this.getNewsItemList():null;return s(n,{key:"4667c40998a74a18a21618be817380680c1f7654",class:"tp-news-list"},s("ul",{key:"f41c0725d1d8147ddea928b1542e1e9181011441",class:{"tp-news-list__list":true,"tp-news-list__list--show":Boolean(i===null||i===void 0?void 0:i.length)||l}},r),s("div",{key:"583b43eaf33d6d77863ead0729bfca2961359b92",class:{"tp-news-list__warning":true,"tp-news-list__warning--show":i&&!i.length}},s("ion-icon",{key:"3243e923283083166e78f23596a40372d1f14818",class:"tp-news-list__warning-icon",src:o.icons.searchX}),s("slot",{key:"9175339c385d16abba4c157f74231980de2eb5be",name:"not-found"})),s("div",{key:"d26f06613c83edd4ff8d3a6362b14633688196b8",class:{"tp-news-list__warning":true,"tp-news-list__warning--show":c}},s("ion-icon",{key:"feca36bf0db9dba11f0c924e11f651cbf10084f8",class:"tp-news-list__warning-icon",src:o.icons.wifiOff}),s("slot",{key:"6fa581ff30a014331cd0fdb1e81150ffcfb7c53c",name:"connection-error"})),s("tp-loader",{key:"a4ea37144c1db30e41f8e248302ee77b490f99b2",class:{"tp-news-list__loader":true,"tp-news-list__loader--show":(i===null||i===void 0?void 0:i.length)&&l},size:"auto"}),s("div",{key:"0c249550fa258a569f780a35eda17981e3a0ea2d",class:{"tp-news-list__button-container":true,"tp-news-list__button-container--show":e!==a&&i&&Boolean(i.length)}},s("ion-button",{key:"f4f2dbefba672d5640ab365ad575da302a7daef2",color:"brand-4",size:"sm",disabled:l,onClick:()=>this.page++},"Carregar mais",s("ion-icon",{key:"2481ba1025d08b41da2dbf5667d5a9f3b463a58e",slot:"end",src:o.icons.plus}))))}static get assetsDirs(){return["assets"]}static get watchers(){return{page:["onLoadMore"],perPage:["onPerPageChange"]}}};p.style=r;export{p as tp_elem_news_list};
//# sourceMappingURL=p-d6ed2106.entry.js.map