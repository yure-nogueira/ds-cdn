import{r as t,c as e,h as s,H as a}from"./p-5c36ed66.js";import{A as o}from"./p-228049e3.js";import{A as r,c as i}from"./p-e5dad5d1.js";import"./p-e5cf9adb.js";const n=".cart-list.sc-tp-elem-cart-list{display:flex;flex-direction:column;gap:8px}.cart-list__total.sc-tp-elem-cart-list{display:flex;justify-content:flex-end;align-items:center;gap:8px}";const l=n;const c=class{constructor(s){t(this,s);this.updatedCart=e(this,"updatedCart",7);this.errorMessage=undefined;this.total=undefined;this.cartItems=undefined;this.itemsData=[]}componentWillLoad(){this.getCart()}async getCart(){const t=await o.getCart();this.cartItems=t.cart;this.total=t.cartTotal}async watchCartItems(){const t=[];this.cartItems.forEach((e=>{const s=r.getProductById(e.id);t.push(s)}));const e=await Promise.all(t);this.itemsData=e.map((t=>{const e=this.cartItems.find((({id:e})=>e===t.id));return{id:e.id,quantity:e.quantity,cartItemKey:e.cartItemKey,name:t.name,shortDescription:t.shortDescription,images:t.images,regularPrice:t.regularPrice,salePrice:t.salePrice,stockQuantity:t.stockQuantity,permalink:t.permalink}}))}handlePlusminus(t){const e=t.target.closest("tp-elem-cart-item");const s=e.getAttribute("cart-key-item");const a=t.detail;this.setItemQuantity(s,a)}handleUpdatedCartCount(t){console.log(t.detail)}async setItemQuantity(t,e){try{const{success:s,cart:a,cartTotal:r,cartCount:i}=await o.updateCart(t,e);if(s){this.cartItems=a;this.total=r;this.errorMessage="";const t={cart:a,cartTotal:r,cartCount:i};this.updatedCart.emit(t)}else{this.errorMessage="O Carrinho não foi atualizado!"}}catch(t){console.error(t)}}async onRemoveFromCart(t){try{const{success:e,cart:s,cartTotal:a,cartCount:r}=await o.removeFromCart(t);if(e){this.cartItems=s;this.total=a;this.errorMessage="";const t={cart:s,cartTotal:a,cartCount:r};this.updatedCart.emit(t)}else{this.errorMessage="O Carrinho não foi atualizado!"}}catch(t){console.log("Não foi possível remover o item do carrinho.")}}render(){const{itemsData:t,total:e,errorMessage:o}=this;const r=t===null||t===void 0?void 0:t.map((t=>{const{id:e,quantity:a,cartItemKey:o,name:r,shortDescription:n,images:l,regularPrice:c,salePrice:p,stockQuantity:u,permalink:m}=t;const h=Number(c)-Number(p);const d=p?Number(p)*a:Number(c)*a;const x=(Number(c)-Number(p))*a;return s("tp-elem-cart-item",{class:"cart-list__item","cart-key-item":o},s("a",{href:m,slot:"image"},s("img",{src:l[0].src,alt:r})),s("ion-text",{"tp-type":"h20x",slot:"title"},s("h2",null,r)),p&&s("ion-text",{color:"neutral-8","tp-type":"p16x",slot:"regular-price"},s("span",null,i(c,"pt-br"))),s("ion-text",{color:"neutral-8","tp-type":"p16xb",slot:"price"},s("span",null,i(p?p:c,"pt-br"))),p&&s("ion-text",{color:"neutral-7","tp-type":"p14x",slot:"save"},s("span",null,"Economize ",i(h,"pt-br"))),s("ion-text",{color:"neutral-7","tp-type":"p16x",slot:"short-description"},s("p",null,n.replace("<p>","").replace("</p>",""))),s("tp-plusminus",{"use-slot":"false",value:Number(a),min:1,max:u?u:9,"automatic-disabled":true,slot:"plusminus"}),s("ion-button",{color:"brand",fill:"clear","tp-no-padding":true,slot:"remove",onClick:()=>this.onRemoveFromCart(e)},"Remover item"),s("ion-text",{color:"neutral-8","tp-type":"h20x",slot:"item-total"},s("span",null,i(d,"pt-br"))),p&&s("ion-text",{class:"cart-item__save",color:"neutral-7","tp-type":"p14x",slot:"save-total"},s("span",null,"Economize ",i(x,"pt-br"))))}));return s(a,null,s("div",{class:"cart-list"},r,s("div",{class:"cart-list__total"},o&&s("ion-text",{"tp-type":"p18xb",color:"warning"},s("p",null,o)),s("ion-text",{"tp-type":"p18xb",color:"neutral-8"},s("h4",null,"Total:")),s("ion-text",{"tp-type":"h24x"},s("h4",null,i(e,"pt-br"))))))}static get watchers(){return{cartItems:["watchCartItems"]}}};c.style=l;export{c as tp_elem_cart_list};
//# sourceMappingURL=p-688c8518.entry.js.map